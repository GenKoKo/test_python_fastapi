{
  "name": "FastAPI Development Environment",
  "dockerComposeFile": "../docker/docker-compose.yml",
  "service": "fastapi-app",
  "workspaceFolder": "/app",
  
  // 配置設定
  "settings": {
    "python.defaultInterpreterPath": "/usr/local/bin/python",
    "python.linting.enabled": true,
    "python.linting.pylintEnabled": false,
    "python.linting.flake8Enabled": true,
    "python.formatting.provider": "black",
    "python.formatting.blackPath": "/usr/local/bin/black",
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
      "source.organizeImports": true
    },
    "files.exclude": {
      "**/__pycache__": true,
      "**/.pytest_cache": true,
      "**/fastapi_env": true
    }
  },

  // VS Code 擴展
  "extensions": [
    "ms-python.python",
    "ms-python.flake8",
    "ms-python.black-formatter",
    "ms-python.pylint",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-json",
    "redhat.vscode-yaml",
    "ms-vscode.docker",
    "GitHub.copilot",
    "ms-toolsai.jupyter",
    "ms-python.debugpy",
    "humao.rest-client"
  ],

  // 端口轉發配置
  "forwardPorts": [8000, 5678],
  "portsAttributes": {
    "8000": {
      "label": "FastAPI Application",
      "onAutoForward": "openBrowser",
      "protocol": "http"
    },
    "5678": {
      "label": "Python Debugger",
      "onAutoForward": "silent"
    }
  },

  // 容器啟動後執行的命令
  "postCreateCommand": "bash .devcontainer/setup.sh && just codespaces-setup",

  // 啟動命令
  "postStartCommand": "bash .devcontainer/start.sh",

  // 用戶設定
  "remoteUser": "root",
  "containerUser": "root",

  // 功能配置
  "features": {
    "ghcr.io/devcontainers/features/common-utils:2": {
      "installZsh": true,
      "configureZshAsDefaultShell": true,
      "installOhMyZsh": true
    },
    "ghcr.io/devcontainers/features/git:1": {
      "ppa": true,
      "version": "latest"
    },
    "ghcr.io/devcontainers/features/github-cli:1": {
      "installDirectlyFromGitHubRelease": true,
      "version": "latest"
    }
  },

  // 掛載配置
  "mounts": [
    "source=${localWorkspaceFolder}/.devcontainer,target=/app/.devcontainer,type=bind,consistency=cached"
  ],

  // 自定義配置
  "customizations": {
    "vscode": {
      "settings": {
        "terminal.integrated.defaultProfile.linux": "zsh",
        "python.testing.pytestEnabled": true,
        "python.testing.unittestEnabled": false,
        "python.testing.pytestArgs": [
          "tests"
        ]
      }
    }
  }
}